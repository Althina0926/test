<!DOCTYPE html>
<html>
<head>
    <title>Quidditch Seeker</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; background: #0b0d17; overflow: hidden; font-family: 'Cinzel Decorative', cursive; }
        canvas { display: block; background: linear-gradient(to bottom, #1a1b3a 0%, #070810 100%); cursor: none; }
        .hud { position: absolute; top: 20px; width: 100%; text-align: center; color: #d4af37; pointer-events: none; text-shadow: 0 0 10px #000; }
        .back-btn { position: absolute; top: 20px; left: 20px; color: #d4af37; text-decoration: none; border: 1px solid #d4af37; padding: 5px 15px; border-radius: 20px; z-index: 100; }
    </style>
</head>
<body>
    <a href="index.html" class="back-btn">⬅ 離開球場</a>
    <div class="hud">
        <h2 id="score">分數: 0</h2>
        <p>方向鍵飛行 | 空白鍵施展咒語</p>
    </div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let score = 0;
        let broom = { x: 100, y: canvas.height/2, w: 80, h: 30 };
        let spells = [];
        let enemies = []; // 博格 Bludgers
        let keys = {};

        window.addEventListener("keydown", e => keys[e.code] = true);
        window.addEventListener("keyup", e => keys[e.code] = false);

        function drawBroom() {
            // 畫掃帚身
            ctx.fillStyle = "#4e2c14";
            ctx.fillRect(broom.x, broom.y + 10, broom.w - 20, 8);
            // 畫掃帚尾
            ctx.fillStyle = "#8b4513";
            ctx.beginPath();
            ctx.moveTo(broom.x, broom.y + 14);
            ctx.lineTo(broom.x - 20, broom.y);
            ctx.lineTo(broom.x - 20, broom.y + 28);
            ctx.fill();
            // 魔法光芒
            ctx.shadowBlur = 15;
            ctx.shadowColor = "#d4af37";
        }

        function spawnEnemy() {
            if (Math.random() < 0.03) {
                enemies.push({ x: canvas.width, y: Math.random() * (canvas.height - 50), r: 15, color: "#333" });
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.shadowBlur = 0;

            // 隨機星空背景
            ctx.fillStyle = "white";
            for(let i=0; i<5; i++) ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 2, 2);

            // 控制掃帚
            if (keys["ArrowUp"] && broom.y > 0) broom.y -= 7;
            if (keys["ArrowDown"] && broom.y < canvas.height - 30) broom.y += 7;
            if (keys["Space"]) {
                spells.push({ x: broom.x + broom.w, y: broom.y